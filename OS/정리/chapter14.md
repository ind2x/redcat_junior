# 키보드 디바이스 드라이버 업그레이드

<br>

키보드 디바이스 드라이버를 인터럽트 기반으로 업그레이드 하고, 데이터 전달 역할을 하는 큐를 생성하여 인터럽트 핸들러에서 셸 코드로 키 정보를 전달하는 방법을 살펴본다.

<br><br>
<hr style="border: 2px solid;">
<br><br>

## 인터럽트 핸들러와 큐

<br>

키 정보를 받을 버퍼를 만들어주는데 바로 원형 큐 형태로 만들어 줄 것이며, 이 버퍼 큐는 단순히 키 정보를 받기 위한 용도가 아닌 범용으로 다양하게 mint64 os에서 사용할 예정이다.

그리고 버퍼에서는 1바이트씩 처리하지 않고 3바이트씩 자료구조 형태로 묶어서 처리한다.

<br>

코드 자체는 원형 큐 구현 코드와 거의 같다.

주의할 점이라고는 버퍼에 접근할 때, 초기화 해줄 때의 큐의 데이터 크기를 이용해서 접근해야 한다는 것이다.

만약 3바이트로 초기화해줬다면 인덱스가 4일 때, 실제로 데이터가 위치한 버퍼의 바이트 오프셋은 12바이트이므로 여기로 접근해줘야 한다.

<br>

![image](https://user-images.githubusercontent.com/52172169/198940744-f17dd543-581b-4770-bb03-07021e99791b.png)

<br><br>
<hr style="border: 2px solid;">
<br><br>

## 키보드 디바이스 드라이버 업그레이드

<br>



<br><br>
<hr style="border: 2px solid;">
<br><br>
