# 간단한 파일 시스템을 구현하자

<br>

이번 장에서는 클러스터 링크를 기반으로 한 파일 시스템 구현, 파일 시스템의 기본이 되는 저수준 함수 구현, 고수준 함수 기반 다지기

<br>

파일 시스템은 저장매체를 관리하는 일종의 규약으로 대표적으로 MS의 FAT 12/16/32가 있다.

따라서 규약이기 때문에 윈도우에서 저장한 파일을 리눅스에서도 읽을 수 있는 것이다. (동일한 규약이기 때문에)

<br>

FAT는 섹터 단위로 데이터를 저장하는 것이 아니라, 여러 섹터 단위(클러스터 단위)로 저장한다.

클러스터는 링크 형식으로 다음 클러스터와 연결된다.

필요한 정보로는 데이터의 크기에 따른 클러스터 개수라든가, 다음 클러스터의 위치가 필요하다.

즉, 클러스터 링크 방식은 필요한 메타 데이터가 적으며 구현이 쉽다.

<br><br>
<hr style="border: 2px solid;">
<br><br>

## MINT 파일 시스템 설계

<br>

우선 우리가 만들 MINT 파일 시스템은 매우 간단한 클러스터 링크 방식의 파일 시스템이다.

아래는 MINT 파일 시스템 특징이다.

<br>

![image](https://user-images.githubusercontent.com/52172169/204119754-2c06f563-08f2-4a62-996a-55831c181f74.png)

<br>

우리의 파일 시스템은 아래와 같고, 특징은 다음과 같다.

<br>

![image](https://user-images.githubusercontent.com/52172169/204119946-bbabd85d-e54c-42bd-8995-2b035bc55664.png)

<br>

![image](https://user-images.githubusercontent.com/52172169/204119949-82c351d7-9a04-4b64-9ee8-3c5ff1e4994c.png)

<br>

가장 중요한 영역은 클러스터 링크 테이블 영역으로, 클러스터의 정보를 저장하고 관리하는데 해당 클러스터의 할당 여부를 저장하고, 다음에 연결된 클러스터의 인덱스를 저장한다.

해당 영역은 데이터를 ```추가 / 삭제 / 읽기``` 를 할 때 사용한다.

<br><br>

### MBR 영역
---

<br>

먼저 **MBR**영역을 살펴본다.

MBR 영역에는 ```부트 코드, 파일 시스템 정보, 파티션 정보```가 들어있다.

파티션이란 하드 디스크를 **논리적**으로 영역을 분할한 것이며, MBR 영역의 뒤쪽의 파티션 테이블 영역에 정보를 기록하여 생성한다.

<br>

![image](https://user-images.githubusercontent.com/52172169/204120391-567bfa54-18e7-4802-ae56-aa5f3ba5b3dd.png)

<br>

파티션 테이블 영은 MBR 시작 어드레스로부터 446바이트 떨어진 곳에 위치하며, 16바이트의 크기로 4개의 파티션이 있다. 

부팅 가능 여부, 파티션의 시작과 끝, 파티션 종류, 총 섹터 수가 저장된다.

<br>

![image](https://user-images.githubusercontent.com/52172169/204120445-ac3959ef-f299-4dc8-a4e9-ccf0a5423500.png)

<br>

파티션을 생성할 때, 곂치는 부분이 있어선 안된다.

파티션 생성은 선택 사항으로, 하드 디스크 전체를 하나의 파일 시스템으로 사용하고자 한다면 파티션 테이블을 모두 0으로 초기화 해주면 된다.

MINT 파일 시스템은 파티션을 사용하지 않는다.

<br><br>

### 예약된 영역
---

<br>



<br><br>

### 클러스터 링크 테이블 영역과 데이터 영역
---

<br>

<br><br>
<hr style="border: 2px solid;">
<br><br>
